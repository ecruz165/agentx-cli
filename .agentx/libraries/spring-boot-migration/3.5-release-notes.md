# Spring Boot 3.5 Release Notes

## Upgrading from Spring Boot 3.4

### spring-boot-parent

The `spring-boot-parent` module is no longer published.
It provides dependency management for internal dependencies used, for example, in Spring Boot's own tests.
If you were using `spring-boot-parent`, replace it with dependency management of your own that meets your application's needs.

### Actuator 'heapdump' Endpoint

The `heapdump` actuator endpoint now defaults to `access=NONE`.
The aims to help reduce the likelihood of a misconfiguration application leaking sensitive information.

If you want to use it, you now need to both expose it, and configure access (_previously, you only needed to expose it_).

To do that, you can use something similar to following configuration:

```yaml
management:
  endpoints:
    web:
      exposure:
        include: heapdump
  endpoint:
    heapdump:
      access: unrestricted
```

### Using '.enabled' and Other Boolean Configuration Properties

Supported values for `.enabled` properties have been tightened with this release and are now more consistent.
Values must now be either `true` or `false`.

Previous versions of Spring Boot would sometimes use conditions that considered any value other than `false` as enabled.

### Validation of Profile Naming

Rules for profile naming have been tightened with this release and are now more consistent.
Profiles can now only contain `-` (dash), `_` (underscore), letters and digits.
Additionally, Profiles are not allowed to start or end with `-` or `_`.

> **Note:** As of Spring Boot 3.5.1 these restrictions have been relaxed a little to also allow `.`, `+` and `@` characters.
You can also set `spring.profiles.validate` to `false` to disable validation entirely.

### Follow Redirects with TestRestTemplate

The `TestRestTemplate` now uses the same follow redirects settings as the regular `RestTemplate`.
The `HttpOption.ENABLE_REDIRECTS` option has also been deprecated.

If the new default settings causes issues with your tests, you can use the `TestRestTemplate.withRedirects(...)` method to pick an alternative follow redirects strategy.

### Auto-configured TaskExecutor Names

Previously Spring Boot auto-configured a `TaskExecutor` with the `taskExecutor` and `applicationTaskExecutor` bean names.
As of this release, only the `applicationTaskExecutor` bean name is provided.
Code that is requesting the auto-configured `Executor` by name should be adapted to use `applicationTaskExecutor`.

If you relied on this behaviour and cannot change it immediately, the alias can be added using a `BeanFactoryPostProcessor`:

```java
@Configuration
public class MyConfiguration {

    @Bean
    static BeanFactoryPostProcessor taskExecutorAliasBeanFactoryPostProcessor() {
        return (beanFactory) -> beanFactory.registerAlias("applicationTaskExecutor", "taskExecutor");
    }

}
```

### Groovy Template Configuration Properties

The `spring.groovy.template.configuration.*` properties have been deprecated in favor of new and existing `spring.groovy.template.*` properties. See the configuration changelog for further details.

### Redis

When `spring.data.redis.url` is configured, the Redis database that is used is determined by the URL.
If the URL does not specify a database, the default of `0` is used.
The `spring.data.redis.database` property is now ignored when `spring.data.redis.url` is configured, aligning its behavior with the host, port, username, and password properties.

### Prometheus Pushgateway

Pushing metrics to a Prometheus Pushgateway now requires `io.prometheus:prometheus-metrics-exporter-pushgateway` instead of `io.prometheus:simpleclient_pushgateway`.

The new client's Pushgateway support may also require a configuration change.
If you were using `management.prometheus.metrics.export.pushgateway.base-url`, replace it with `management.prometheus.metrics.export.pushgateway.address` and adjust the value to be in the form `host:port`.

Three new properties have been added in support of the new Pushgateway client:

- `management.prometheus.metrics.export.pushgateway.format`
- `management.prometheus.metrics.export.pushgateway.scheme`
- `management.prometheus.metrics.export.pushgateway.token`

### Native Test with Maven

The `nativeTest` profile has been harmonized with `native` to make it friendly for multi-module projects.
Native test execution will not occur unless the Spring Boot and Native Build tools plugin are defined in the project.

### ECS Structured Logging JSON

JSON output for ECS structure logging has been updated to use the nested format.
This should improve compatibility with the backends that consume the JSON.

### Apache Pulsar
The default version of the Apache Pulsar client has been upgraded from 3.3.x to 4.0.x.
This upgrade was made to align with the Apache Pulsar release policy.
3.3.x has now reached end-of-life and 4.0.x is a new LTS release.

### Couchbase Capella
Due to changes in Spring Boot's support for configuring Couchbase to use SSL, Couchbase Capella's embedded certificate will no longer be picked up automatically.
If you are using Capella and want to trust its embedded certificate, create an SSL bundle with a truststore that references the certificate and configure Couchbase to use it:

```yaml
spring:
  ssl:
    bundle:
      pem:
        couchbase-bundle:
          truststore:
            # Note that this certificate is fetched from the `com.couchbase.client:code-io` dependency.
            certificate: classpath:com/couchbase/client/core/env/capella-ca.pem
  couchbase:
    env:
      ssl:
        bundle: couchbase-bundle
```

### Deprecations from Spring Boot 3.3

Classes, methods, and properties that were deprecated in Spring Boot 3.3 and marked for removal in 3.5 have been removed in this release. Please ensure that you aren't calling deprecated methods or otherwise using deprecated functionality before upgrading.

### Minimum Requirements Changes

None.

## New and Noteworthy

> **Tip:** Check the configuration changelog for a complete overview of the changes in configuration.

### Annotations to Register Filter and Servlet

As an annotation-based alternative to `ServletRegistrationBean` and `FilterRegistrationBean` two new annotations have been added.
`@ServletRegistration` can be used to register `Servlet`, while `@FilterRegistration` can be used to register `Filter`, as shown in this example:

```java
@Configuration(proxyBeanMethods = false)
class MyConfiguration {

    @Bean
    @FilterRegistration(name = "my-filter", urlPatterns = "/test/*", order = 0)
    MyFilter myFilter() {
        return new MyFilter();
    }

}
```

### Load Properties From Environment Variables

While it was already possible to load a single property from an environment variable, it's now possible to load multiple properties from a single environment variable.

For example, the multi-line environment variable `MY_CONFIGURATION` with this content:

```
my.var1=value1
my.var2=value2
```

can now be imported using the `env:` prefix:

```properties
spring.config.import=env:MY_CONFIGURATION
```

After this, `my.var1` and `my.var2` are available in the `Environment`.

### Customizing Structured Logging Stack Traces

Stack Trace written to structured logs can now be customized to limit their size or print them in a different format.
You can use the `logging.structured.json.stacktrace.*` properties to configure stack trace output.

### ClientHttpConnector Builder and Configuration Properties

Users of `WebClient` can now use properties for global configuration such as timeouts and redirect settings.
This feature aligns with the support that we added for blocking clients in Spring Boot 3.4.

### SSL Support for Service Connections

Client side SSL support has been added for selected service connections.
This is supported for the following service connections:

- Cassandra
- Couchbase
- Elasticsearch
- Kafka
- MongoDB
- RabbitMQ
- Redis

The Testcontainers and Docker Compose integrations have been updated to allow SSL configuration, too.

### Task Decoration for Scheduled Tasks

If a `TaskDecorator` bean is present, it is applied to the auto-configured `taskScheduler` bean.
It is also applied to the auto-configured `ThreadPoolTaskSchedulerBuilder` and `SimpleAsyncTaskSchedulerBuilder` beans.

### AsyncTaskExecutor with Custom Executor

If an `Executor` bean is present, Spring Boot can now be configured to auto-configure an `AsyncTaskExecutor` anyway.
To do so, set the `spring.task.execution.mode` property to `force`.

### OpenTelemetry

Spring Boot now supports the `OTEL_RESOURCE_ATTRIBUTES` and `OTEL_SERVICE_NAME` environment variables.
Resource attributes configured through the configuration property take precedence over those from the environment variables.

Additionally, support for the `service.namespace` resource attribute has been added.
The value of this attribute is read from the `spring.application.group` configuration property.

### Spring Batch

The `JobParametersConverter` used by Spring Batch can now be customised by defining a bean of that type.
When no such bean is defined the `DefaultJobParametersConverter` will be used as before.

The new `spring.batch.jdbc.validate-transaction-state` property can be used to control whether transaction state is validated.

### OAuth 2 Client Auto-configuration

OAuth 2 Client auto-configuration now applies in more situations and is more granular.

- `OAuth2ClientAutoConfiguration` configure OAuth 2 client related beans in anything other than a reactive web application.
- `OAuth2ClientWebSecurityAutoConfiguration` configures OAuth 2 client based web security in a servlet web application.
- `ReactiveOAuth2ClientAutoConfiguration` configures reactive OAuth 2 client related beans in anything other than a servlet web application.
- `ReactiveOAuth2ClientWebSecurityAutoConfiguration` configures OAuth 2 client based web security in a reactive web application.

### Auto-configuration for Bean Background Initialization

Spring Boot now auto-configures a bean named `bootstrapExecutor` if it's not already there.
This enables bean background initialization out of the box.

### Redis

Add support for configuring `ReadFrom` using the `spring.data.redis.lettuce.read-from` property.

### Liquibase
The managed version of Liquibase is now 4.31.0.
Two new Liquibase properties have been added:

- `spring.liquibase.analytics-enabled` – Whether to send product usage data and analytics to Liquibase
- `spring.liquibase.license-key` – Liquibase Pro license key

### Vibur Connection Pool
Support for configuring a Vibur DBCP connection pool using `DataSourceBuilder` has been added.
Dependency management has also been updated to cover `org.vibur:vibur-dbcp`.

### Testcontainers and Docker Compose support for `lldap/lldap` containers

Containers using the `lldap/lldap` image can now be used with Docker Compose and Testcontainers.
Testcontainers supports this image with `LLdapContainer`.

### Cloud Native Buildpacks

#### Ubuntu Noble

The default builder has been switched to `paketobuildpacks/builder-noble-java-tiny`.
The resulting image doesn't have a shell or other utilities.
If you need a shell, you can use `paketobuildpacks/ubuntu-noble-run-base` as the run image.

#### Docker Config Authentication

Both the Maven and Gradle plugin will now attempt to use authentication settings from your docker `config.json` file.
This includes support for executing credential helpers to support things like the MacOS keychain.

### Triggering Quartz Jobs From the Actuator

The Quartz Actuator endpoint can now be used to trigger Quartz jobs by sending an HTTP POST to the `/actuator/quartz/jobs/{groupName}/{jobName}` URL.

### SSL Bundle Metrics

Spring Boot Actuator now publishes metrics for SSL bundles.
The metric `ssl.chains` counts the number of chains and their status (valid, expired, soon-to-be-expired, not-yet-valid).
The metric `ssl.chain.expiry` tracks the number of seconds until expiry for each certificate chain.

### Mappings Endpoint

The mappings endpoint now includes information about WebMvc.fn router functions.

### Dependency Upgrades

Spring Boot 3.5 moves to new versions of several Spring projects:

* Spring Authorisation Server 1.5.0
* Spring Data 2025.0.0
* Spring GraphQL 1.4.0
* Spring HATEOAS 2.5.0
* Spring Integration 6.5.0
* Spring LDAP 3.3.0
* Spring Security 6.5.0
* Spring Session 3.5.0
* Spring WS 4.1.0

Numerous third-party dependencies have also been updated, some of the more noteworthy of which are the following:

* Artemis 2.40
* AssertJ 3.27
* Awaitility 4.3
* Brave 6.1.0
* Byte Buddy 1.17
* Caffeine 3.2
* Cassandra Driver 4.19
* Commons Codec 1.18
* Commons DBCP 2.13
* Elasticsearch Client 8.17
* Flyway 11.7
* GraphQL Java 23.1
* Gson 2.13
* Hamcrest 3.0
* HikariCP 6.3
* HtmlUnit 4.11
* InfluxDB Java 2.25
* Jaybird 6.0
* JUnit Jupiter 5.12
* Kafka 3.9
* Liquibase 4.31
* Micrometer 1.15.0
* Micrometer Tracing 1.5.0
* Mockito 5.17
* MongoDB 5.4
* MSSQL JDBC 12.10
* MySQL 9.2
* OpenTelemetry 1.49
* Oracle Database 23.7.0.25.01
* Pulsar 4.0
* Pulsar Reactive 0.6.0
* Quartz 2.5
* R2DBC MySQL 1.4
* Rabbit AMQP Client 5.25
* Rabbit Stream Client 0.23
* Selenium 4.31
* Selenium HtmlUnit 4.30
* SnakeYAML 2.4
* SQLite JDBC 3.49
* Testcontainers 1.21
* Thymeleaf Layout Dialect 3.4.0
* UnboundID LDAPSDK 7.0
* WebJars Locator Lite 1.1
* Zipkin Reporter 3.5.0

## Deprecations in Spring Boot 3.5.0

* `ConditionalOutcome.inverse(...)` has been deprecated for removal since it doesn't generate a useful message
* Support for SignalFX has been deprecated, following the deprecation in Micrometer.
* The configuration property `spring.mvc.converters.preferred-json-mapper` has been deprecated. It is replaced by `spring.http.converters.preferred-json-mapper`.
* The configuration properties `spring.codec.log-request-details` and `spring.codec.max-in-memory-size` have been deprecated. They are replaced by `spring.http.codecs.log-request-details` and `spring.http.codecs.max-in-memory-size` respectively.
